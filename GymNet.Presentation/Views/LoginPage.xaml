<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="GymNet.Presentation.Views.LoginPage"
             BackgroundColor="{StaticResource ColorBackground}">

    <Grid>
        <!-- Fondo degradado -->
        <Grid.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#020617" Offset="0.0" />
                <GradientStop Color="#0B1120" Offset="0.45" />
                <GradientStop Color="#020617" Offset="1.0" />
            </LinearGradientBrush>
        </Grid.Background>

        <ScrollView>
            <VerticalStackLayout x:Name="RootLayout"
                                 HorizontalOptions="Center"
                                 VerticalOptions="CenterAndExpand"
                                 Spacing="16"
                                 Padding="{OnIdiom Phone='24,24,24,24',
                                                  Tablet='40,40,40,40'}"
                                 MaximumWidthRequest="{OnIdiom Phone=420, Tablet=600}">

                <!-- Header con toggle de tema -->
                <Grid x:Name="HeaderArea"
                      ColumnDefinitions="*,Auto"
                      Margin="0,0,0,16">
                    <VerticalStackLayout Grid.Column="0"
                                         Spacing="4">
                        <Label Text="GymNet"
                               FontSize="{OnIdiom Phone=30, Tablet=34}"
                               FontAttributes="Bold"
                               TextColor="{StaticResource ColorTextPrimary}" />
                        <Label Text="Tu red social para el entrenamiento."
                               FontSize="{OnIdiom Phone=13, Tablet=15}"
                               TextColor="{StaticResource ColorTextMuted}" />
                    </VerticalStackLayout>

                    <Button Grid.Column="1"
                            x:Name="ThemeToggleButton"
                            Text="🌓"
                            BackgroundColor="Transparent"
                            TextColor="{StaticResource ColorTextMuted}"
                            FontSize="20"
                            Padding="8"
                            Clicked="OnToggleThemeClicked" />
                </Grid>

                <!-- Tarjeta de login -->
                <Border x:Name="Card"
                        BackgroundColor="{StaticResource ColorBackgroundCard}"
                        Padding="{OnIdiom Phone='20,20,20,20',
                                         Tablet='28,28,28,28'}">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="{OnIdiom Phone=24, Tablet=32}" />
                    </Border.StrokeShape>
                    <Border.Shadow>
                        <Shadow Brush="#000000"
                                Radius="24"
                                Opacity="0.35"
                                Offset="0,8" />
                    </Border.Shadow>

                    <VerticalStackLayout Spacing="{OnIdiom Phone=14, Tablet=18}">

                        <Label Text="Inicia sesión"
                               FontSize="{OnIdiom Phone=18, Tablet=20}"
                               FontAttributes="Bold"
                               TextColor="{StaticResource ColorTextPrimary}" />

                        <!-- Email -->
                        <VerticalStackLayout Spacing="4">
                            <Label Text="Email"
                                   FontSize="12"
                                   TextColor="{StaticResource ColorTextMuted}" />

                            <Border BackgroundColor="#020617"
                                    Padding="10,0"
                                    StrokeThickness="0">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="22" />
                                </Border.StrokeShape>

                                <Grid ColumnDefinitions="Auto,*"
                                      ColumnSpacing="8"
                                      HeightRequest="44">
                                    <Image Source="icon_email.png"
                                           WidthRequest="18"
                                           HeightRequest="18"
                                           VerticalOptions="Center" />

                                    <Entry x:Name="EmailEntry"
                                           Grid.Column="1"
                                           Style="{StaticResource GymEntryStyle}"
                                           Placeholder="tu@email.com"
                                           Keyboard="Email"
                                           ReturnType="Next"
                                           Completed="OnEmailCompleted"
                                           Text="{Binding Email}" />
                                </Grid>
                            </Border>
                        </VerticalStackLayout>

                        <!-- Password -->
                        <VerticalStackLayout Spacing="4">
                            <Label Text="Contraseña"
                                   FontSize="12"
                                   TextColor="{StaticResource ColorTextMuted}" />

                            <Border BackgroundColor="#020617"
                                    Padding="10,0"
                                    StrokeThickness="0">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="22" />
                                </Border.StrokeShape>

                                <Grid ColumnDefinitions="Auto,*"
                                      ColumnSpacing="8"
                                      HeightRequest="44">
                                    <Image Source="icon_lock.png"
                                           WidthRequest="18"
                                           HeightRequest="18"
                                           VerticalOptions="Center" />

                                    <Entry x:Name="PasswordEntry"
                                           Grid.Column="1"
                                           Style="{StaticResource GymEntryStyle}"
                                           Placeholder="••••••••"
                                           IsPassword="True"
                                           ReturnType="Go"
                                           Completed="OnPasswordCompleted"
                                           Text="{Binding Password}" />
                                </Grid>
                            </Border>
                        </VerticalStackLayout>

                        <!-- Olvidada -->
                        <Label Text="¿Has olvidado la contraseña?"
                               FontSize="11"
                               TextColor="{StaticResource ColorAccent}"
                               HorizontalOptions="End" />

                        <!-- Botones -->
                        <Button Text="Entrar"
                                Style="{StaticResource PrimaryButtonStyle}"
                                Command="{Binding SignInCommand}" />

                        <Button Text="Crear una cuenta nueva"
                                Style="{StaticResource TextButtonStyle}"
                                Command="{Binding RegisterCommand}" />

                        <!-- Loading -->
                        <ActivityIndicator IsRunning="{Binding IsBusy}"
                                           IsVisible="{Binding IsBusy}"
                                           Color="{StaticResource ColorPrimary}"
                                           HorizontalOptions="Center"
                                           Margin="0,4,0,0" />

                        <!-- Error -->
                        <Label Text="{Binding ErrorMessage}"
                               TextColor="{StaticResource ColorDanger}"
                               FontSize="12"
                               LineBreakMode="WordWrap"
                               Margin="0,4,0,0"
                               IsVisible="{Binding ErrorMessage, Converter={StaticResource NullToBoolConverter}}" />
                    </VerticalStackLayout>
                </Border>

                <!-- Pie -->
                <Label Text="By lifters, for lifters 💪"
                       HorizontalOptions="Center"
                       Margin="0,16,0,0"
                       FontSize="{OnIdiom Phone=11, Tablet=12}"
                       TextColor="{StaticResource ColorTextMuted}" />

            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage>
