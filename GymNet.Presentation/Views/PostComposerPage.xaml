<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="GymNet.Presentation.Views.PostComposerPage"
             BackgroundColor="{StaticResource ColorBackground}">

	<Grid>
		<!-- Fondo -->
		<Grid.Background>
			<LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
				<GradientStop Color="#020617" Offset="0.0" />
				<GradientStop Color="#0B1120" Offset="0.45" />
				<GradientStop Color="#020617" Offset="1.0" />
			</LinearGradientBrush>
		</Grid.Background>

		<ScrollView>
			<VerticalStackLayout Padding="{OnIdiom Phone='16,16,16,16', Tablet='24,24,24,24'}"
                                 Spacing="16"
                                 HorizontalOptions="Center"
                                 VerticalOptions="CenterAndExpand"
                                 MaximumWidthRequest="{OnIdiom Phone=420, Tablet=600}">

				<!-- Header -->
				<HorizontalStackLayout Spacing="8"
                                       VerticalOptions="Center">
					<Button Text="←"
                            BackgroundColor="Transparent"
                            TextColor="{StaticResource ColorTextMuted}"
                            Padding="0"
                            FontSize="20"
                            Clicked="OnBackClicked" />
					<Label Text="Nuevo post"
                           FontSize="{OnIdiom Phone=20, Tablet=22}"
                           FontAttributes="Bold"
                           TextColor="{StaticResource ColorTextPrimary}" />
				</HorizontalStackLayout>

				<!-- Tarjeta -->
				<Border BackgroundColor="{StaticResource ColorBackgroundCard}"
                        Padding="{OnIdiom Phone='16,16,16,16',
                                         Tablet='22,22,22,22'}">
					<Border.StrokeShape>
						<RoundRectangle CornerRadius="{OnIdiom Phone=20, Tablet=26}" />
					</Border.StrokeShape>
					<Border.Shadow>
						<Shadow Brush="#000000"
                                Radius="20"
                                Opacity="0.35"
                                Offset="0,8" />
					</Border.Shadow>

					<VerticalStackLayout Spacing="12">

						<Label Text="Cuéntanos tu entrenamiento de hoy"
                               FontSize="14"
                               TextColor="{StaticResource ColorTextMuted}" />

						<Editor x:Name="TextEditor"
                                Text="{Binding Text}"
                                Placeholder="Por ejemplo: 'Hoy pecho y tríceps, he subido marcas en press banca…'"
                                AutoSize="TextChanges"
                                FontSize="14"
                                TextColor="{StaticResource ColorTextPrimary}"
                                PlaceholderColor="{StaticResource ColorTextMuted}"
                                BackgroundColor="Transparent"
                                MinimumHeightRequest="120" />

						<!-- Línea auxiliar -->
						<BoxView HeightRequest="1"
                                 Color="#1F2937"
                                 Opacity="0.8"
                                 Margin="0,4,0,4" />

						<!-- Fila inferior: contador + estado -->
						<Grid ColumnDefinitions="*,Auto">
							<Label Text="{Binding RemainingChars, StringFormat='Caracteres restantes: {0}'}"
                                   FontSize="11"
                                   TextColor="{StaticResource ColorTextMuted}" />

							<ActivityIndicator Grid.Column="1"
                                               IsRunning="{Binding IsBusy}"
                                               IsVisible="{Binding IsBusy}"
                                               Color="{StaticResource ColorPrimary}" />
						</Grid>

						<Label Text="{Binding LastResult}"
                               FontSize="12"
                               TextColor="{StaticResource ColorTextMuted}"
                               LineBreakMode="WordWrap" />
					</VerticalStackLayout>
				</Border>

				<!-- Botón publicar -->
				<Button Text="Publicar"
                        Style="{StaticResource PrimaryButtonStyle}"
                        Command="{Binding PublishAsyncCommand}" />

			</VerticalStackLayout>
		</ScrollView>
	</Grid>
</ContentPage>


